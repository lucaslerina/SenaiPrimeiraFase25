<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Game Avançado</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background-color: #222;
    color: #fff;
    font-family: sans-serif;
    margin: 0;
  }

  #gameCanvas {
    background-color: #000;
    border: 2px solid #fff;
    margin-top: 10px;
  }

  #score {
    font-size: 20px;
  }

  #gameOver {
    display: none;
    font-size: 24px;
    color: red;
    margin-top: 10px;
  }

  #restartBtn {
    display: none;
    margin-top: 10px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="score">Pontuação: 0</div>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<div id="gameOver">Game Over!</div>
<button id="restartBtn">Reiniciar Jogo</button>

<script>
window.onload = function() {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreElement = document.getElementById('score');
    const gameOverElement = document.getElementById('gameOver');
    const restartBtn = document.getElementById('restartBtn');

    const gridSize = 20;
    const tileCount = canvas.width / gridSize;

    let snake, velocityX, velocityY, tailLength, apple, score, speed, gameInterval;

    function initGame() {
        snake = [{x:10,y:10}];
        velocityX = 1;
        velocityY = 0;
        tailLength = 1;
        score = 0;
        speed = 150;
        apple = {x:Math.floor(Math.random()*tileCount), y:Math.floor(Math.random()*tileCount)};
        scoreElement.textContent = "Pontuação: " + score;
        gameOverElement.style.display = 'none';
        restartBtn.style.display = 'none';

        if(gameInterval) clearInterval(gameInterval);
        gameInterval = setInterval(gameLoop, speed);
    }

    function gameLoop() {
        const head = {x: snake[0].x + velocityX, y: snake[0].y + velocityY};

        // Colisão com parede
        if(head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
            endGame();
            return;
        }

        // Colisão com o próprio corpo
        for(let segment of snake) {
            if(segment.x === head.x && segment.y === head.y) {
                endGame();
                return;
            }
        }

        snake.unshift(head);
        while(snake.length > tailLength) snake.pop();

        // Pegar maçã
        if(head.x === apple.x && head.y === apple.y){
            tailLength++;
            score++;
            scoreElement.textContent = "Pontuação: " + score;
            apple.x = Math.floor(Math.random() * tileCount);
            apple.y = Math.floor(Math.random() * tileCount);

            // Aumenta a velocidade a cada 5 pontos
            if(score % 5 === 0) {
                speed = Math.max(50, speed - 10);
                clearInterval(gameInterval);
                gameInterval = setInterval(gameLoop, speed);
            }
        }

        draw();
    }

    function draw() {
        // Limpa o canvas
        ctx.fillStyle = 'black';
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // Cobra
        for(let i = 0; i < snake.length; i++) {
            ctx.fillStyle = `hsl(${i*20 % 360}, 80%, 50%)`; // cores diferentes
            ctx.fillRect(snake[i].x*gridSize, snake[i].y*gridSize, gridSize, gridSize);
        }

        // Maçã
        ctx.fillStyle = 'green';
        ctx.fillRect(apple.x*gridSize, apple.y*gridSize, gridSize, gridSize);
    }

    function endGame() {
        clearInterval(gameInterval);
        gameOverElement.style.display = 'block';
        restartBtn.style.display = 'inline-block';
    }

    window.addEventListener('keydown', e=>{
        switch(e.key){
            case 'ArrowUp': if(velocityY!==1){velocityX=0;velocityY=-1;} break;
            case 'ArrowDown': if(velocityY!==-1){velocityX=0;velocityY=1;} break;
            case 'ArrowLeft': if(velocityX!==1){velocityX=-1;velocityY=0;} break;
            case 'ArrowRight': if(velocityX!==-1){velocityX=1;velocityY=0;} break;
        }
    });

    restartBtn.addEventListener('click', initGame);

    // Inicia o jogo automaticamente
    initGame();
};
</script>

</body>
</html>
